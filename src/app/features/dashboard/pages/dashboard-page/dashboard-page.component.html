<div class="dashboard-page">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1 class="dashboard-title">Dashboard & Analytics</h1>
      <p class="dashboard-subtitle">Track your fitness journey and progress</p>
    </div>
    <div class="view-toggle">
      <button 
        class="toggle-btn" 
        [class.active]="selectedView === 'weekly'"
        (click)="switchView('weekly')">
        Weekly
      </button>
      <button 
        class="toggle-btn" 
        [class.active]="selectedView === 'monthly'"
        (click)="switchView('monthly')">
        Monthly
      </button>
    </div>
  </div>

  <!-- Stats Overview -->
  @if (isLoadingStats) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading statistics...</p>
    </div>
  } @else if (statsError) {
    <div class="error-container">
      <span class="material-symbols-rounded">error</span>
      <p>{{ statsError }}</p>
      <button (click)="loadDashboardData()" class="retry-btn">Retry</button>
    </div>
  } @else if (stats) {
    <div class="stats-grid">
      <app-stat-card
        icon="ðŸƒ"
        label="Total Workouts"
        [value]="stats.totalWorkouts"
        unit="sessions"
        [trend]="12.5"
        period="week">
      </app-stat-card>

      <app-stat-card
        icon="ðŸ”¥"
        label="Calories Burned"
        [value]="stats.totalCalories"
        unit="kcal"
        [trend]="8.3"
        period="week">
      </app-stat-card>

      <app-stat-card
        icon="ðŸ“"
        label="Total Distance"
        [value]="stats.totalDistance"
        unit="km"
        [trend]="15.7"
        period="week">
      </app-stat-card>

      <app-stat-card
        icon="â±ï¸"
        label="Total Duration"
        [value]="formatDuration(stats.totalDuration)"
        unit=""
        [trend]="6.2"
        period="week">
      </app-stat-card>
    </div>
  }

  <!-- Weekly View -->
  @if (selectedView === 'weekly') {
    @if (isLoadingCharts) {
      <div class="loading-container">
        <div class="spinner"></div>
        <p>Loading charts...</p>
      </div>
    } @else if (chartsError) {
      <div class="error-container">
        <span class="material-symbols-rounded">error</span>
        <p>{{ chartsError }}</p>
        <button (click)="loadDataForSelectedView()" class="retry-btn">Retry</button>
      </div>
    } @else {
      <div class="charts-section">
        <div class="chart-row">
          <div class="chart-col-large">
            <app-line-chart
              title="Weekly Activity Trends"
              [labels]="weeklyChartLabels"
              [datasets]="weeklyChartDatasets">
            </app-line-chart>
          </div>
          <div class="chart-col-small">
            <app-doughnut-chart
              title="Activity Breakdown"
              [labels]="activityLabels"
              [data]="activityData"
              [backgroundColor]="activityColors">
            </app-doughnut-chart>
          </div>
        </div>

        <!-- Weekly Summary -->
        @if (isLoadingSummary) {
          <div class="loading-container-small">
            <div class="spinner-small"></div>
            <p>Loading summary...</p>
          </div>
        } @else if (summaryError) {
          <div class="error-container-small">
            <span class="material-symbols-rounded">error</span>
            <p>{{ summaryError }}</p>
          </div>
        } @else if (weeklySummary) {
          <div class="summary-card">
            <h3 class="summary-title">ðŸ“Š Weekly Summary</h3>
            <div class="summary-content">
              <div class="summary-item">
  @if (selectedView === 'monthly') {
    @if (isLoadingCharts) {
      <div class="loading-container">
        <div class="spinner"></div>
        <p>Loading charts...</p>
      </div>
    } @else if (chartsError) {
      <div class="error-container">
        <span class="material-symbols-rounded">error</span>
        <p>{{ chartsError }}</p>
        <button (click)="loadDataForSelectedView()" class="retry-btn">Retry</button>
      </div>
    } @else {
      <div class="charts-section">
        <div class="chart-row">
          <div class="chart-col-large">
            <app-bar-chart
              title="Monthly Activity Overview"
              [labels]="monthlyChartLabels"
              [datasets]="monthlyChartDatasets">
            </app-bar-chart>
          </div>
          <div class="chart-col-small">
            <app-doughnut-chart
              title="Activity Breakdown"
              [labels]="activityLabels"
              [data]="activityData"
              [backgroundColor]="activityColors">
            </app-doughnut-chart>
          </div>
        </div>

        <!-- Monthly Summary -->
        @if (isLoadingSummary) {
          <div class="loading-container-small">
            <div class="spinner-small"></div>
            <p>Loading summary...</p>
          </div>
        } @else if (summaryError) {
          <div class="error-container-small">
            <span class="material-symbols-rounded">error</span>
            <p>{{ summaryError }}</p>
          </div>
        } @else if (monthlySummary) {
          <div class="summary-card">
            <h3 class="summary-title">ðŸ“ˆ Monthly Summary</h3>
            <div class="summary-content">
              <div class="summary-item">
                <span class="summary-label">Month:</span>
                <span class="summary-value">{{ monthlySummary.month }} {{ monthlySummary.year }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Total Workouts:</span>
                <span class="summary-value">{{ monthlySummary.totalWorkouts }} sessions</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Total Calories:</span>
                <span class="summary-value">{{ monthlySummary.totalCalories }} kcal</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Total Distance:</span>
                <span class="summary-value">{{ monthlySummary.totalDistance }} km</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Avg Workouts/Week:</span>
                <span class="summary-value">{{ monthlySummary.avgWorkoutsPerWeek }}</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Top Activity:</span>
                <span class="summary-value highlight">{{ monthlySummary.topActivity }}</span>
              </div>
            </div>
          </div>
        }
      </div>
    }
  }iv class="summary-content">
        <div class="summary-item">
          <span class="summary-label">Month:</span>
          <span class="summary-value">{{ monthlySummary.month }} {{ monthlySummary.year }}</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Total Workouts:</span>
          <span class="summary-value">{{ monthlySummary.totalWorkouts }} sessions</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Total Calories:</span>
          <span class="summary-value">{{ monthlySummary.totalCalories }} kcal</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Total Distance:</span>
          <span class="summary-value">{{ monthlySummary.totalDistance }} km</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Avg Workouts/Week:</span>
          <span class="summary-value">{{ monthlySummary.avgWorkoutsPerWeek }}</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Top Activity:</span>
          <span class="summary-value highlight">{{ monthlySummary.topActivity }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Goals Section -->
  <div class="goals-section" *ngIf="stats">
    <div class="goal-card">
      <h3 class="goal-title">ðŸŽ¯ Weekly Goal Progress</h3>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="stats.weeklyGoalProgress"></div>
      </div>
      <p class="progress-text">{{ stats.weeklyGoalProgress }}% Complete</p>
    </div>
    
    <div class="goal-card">
      <h3 class="goal-title">ðŸŽ¯ Monthly Goal Progress</h3>
      <div class="progress-bar">
        <div class="progress-fill monthly" [style.width.%]="stats.monthlyGoalProgress"></div>
      </div>
      <p class="progress-text">{{ stats.monthlyGoalProgress }}% Complete</p>
    </div>
  </div>
</div>
